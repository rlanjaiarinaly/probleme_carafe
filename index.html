<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coursera</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="board">
        <div class="c1 carafe">
            <div class="value">
                0
            </div>
            <div class="content"></div>
        </div>
        <div class="c2 carafe" >
            <div class="value">
                0
            </div>
            <div class="content"></div>
        </div>
    </div>
    <script src="index.js"></script>
    <script>
        const v1 = parseInt(prompt("Entrez une valeur de carafe"))
        const v2 = parseInt(prompt("Entrez une valeur de carafe"))

        const c2 = document.querySelector(".c2") 
        const c1 = document.querySelector(".c1")

        const max = v1 > v2 ? v1 : v2
        const min = v1 > v2 ? v2 : v1
        
        c1.style.height = `${max*100}px`
        /*c1.querySelector(".value").innerHTML = max
        c2.querySelector(".value").innerHTML = min*/
        c2.style.height = `${min*100}px`
        const carafe1 = new Carafe(max,c1)
        const carafe2 = new Carafe(min,c2)

        let current_waiting = 1000
        r  = resoudre(carafe1,carafe2,2)
        for(let i = 0; i < r.length; i++){
            console.log(current_waiting)
            setTimeout(function(){
                const bin = r[i][0]
                const [action,target] = r[i][1].split(",")
                if(action == "remplir"){
                    if(target == "min"){
                        animate_liquid(0, bin[1]*100/min,c2.querySelector(".content")).play()
                    }else{
                        animate_liquid(0, bin[0]*100/max,c1.querySelector(".content")).play()
                    }
                }else if(action == "vider"){
                    const last_bin = r[i-1][0]
                    console.log(last_bin)
                    if(target == "min"){
                        animate_liquid(last_bin[1]*100/min, 0,c2.querySelector(".content")).play()
                    }else{
                        animate_liquid(last_bin[0]*100/max, 0,c1.querySelector(".content")).play()
                    }
                }else{
                    const last_bin = r[i-1][0]
                    if(target == "min"){
                        animate_transvaser(c2,c1,"left",bin.reverse(),last_bin.reverse(),min,max)
                    }else{
                        animate_transvaser(c1,c2,"right",bin,last_bin,max,min)
                    }
                }
            },current_waiting)
            current_waiting += 2100
        }
    </script>
</body>
</html>